.\" Automatically generated by Pandoc 3.6.2
.\"
.TH "zram\-config" "1" "February 2025" ""
.SH NAME
zram\-config \- A complete utility for swap, directories, and logs to
reduce SD, NAND and eMMC block wear
.SH SYNOPSIS
\f[B]zram\-config\f[R] {start|stop|sync}
.SH DESCRIPTION
\f[B]zram\-config\f[R] is a utility for swap, directories, and logs to
reduce SD, NAND and eMMC block wear.
Furthermore zram allows near RAM speed access to working directories,
and prevents frequent writing to persistent storage.
Even more importantly, data stored in zram can be compressed to conserve
memory.
.PP
\f[B]zram\-config\f[R] is configured by a table located at
\f[CR]/etc/ztab\f[R] is used to configure any number and type of zram
devices.
Using the table a zram device is configured and mounted to an OverlayFS
filesystem as the upper filesystem.
OverlayFS is used so that files do not need to be copied from persistent
storage to RAM on startup.
In theory this should allow for faster boots and larger directories as
no complete directory copy is needed.
.PP
Because all configuration is performed in the table at
\f[CR]/etc/ztab\f[R] the only commands accepted are as follows:
.IP \[bu] 2
\f[I]start\f[R] \- Starts up zram as configured in \f[CR]/etc/zram\f[R].
If the table has been edited since the zram was last started, only the
newly configured devices will be started.
.IP \[bu] 2
\f[I]stop\f[R] \- Stops any running devices configured by zram\-config
and syncs the changes back to persistent storage.
.IP \[bu] 2
\f[I]sync\f[R] \- Syncs any changes back to persistent storage.
This ensures no data will be lost in the case of sudden power loss.
.PP
As a general rule, be sure that any services that are using configured
zram devices are stopped before running zram\-config.
.SH OPTIONS
All options are configured in \f[CR]/etc/ztab\f[R].
The format for \f[CR]/etc/ztab\f[R] is one device configuration per line
with each option separated by a tab character.
The device can be one of \f[CR]swap\f[R], \f[CR]dir\f[R], or
\f[CR]log\f[R].
There is little difference between \f[CR]dir\f[R] and \f[CR]log\f[R]
except that \f[CR]log\f[R] has additional options for log rotation.
A \f[CR]#\f[R] can be used at the start of any line to comment it out.
The options are as follows:
.IP \[bu] 2
\f[I]alg\f[R] \- All algorithms in \f[CR]/proc/crypto\f[R] are supported
but only \f[CR]lzo\-rle\f[R], \f[CR]lzo\f[R], \f[CR]lz4\f[R], and
\f[CR]zstd\f[R] have zramctl text strings; \f[CR]lzo\-rle\f[R] is the
fastest with \f[CR]zstd\f[R] having much better text compression.
.IP \[bu] 2
\f[I]mem_limit\f[R] \- The compressed memory limit and will set a hard
memory limit for the system admin.
Set to 0 to disable the \f[CR]mem_limit\f[R].
.IP \[bu] 2
\f[I]disk_size\f[R] \- The maximum size of the uncompressed memory.
It should be set to roughly 150% of \f[CR]mem_limit\f[R] depending on
the algorithm and how compressible the input files are.
Don\[cq]t make it much higher than the compression algorithm (and the
additional zram overhead) is capable of because there is a \[ti]0.1%
memory overhead when empty.
.IP \[bu] 2
\f[I]swap_priority\f[R] \- Can be used to set zram at a higher priority
over alternative swap devices.
.IP \[bu] 2
\f[I]page\-cluster\f[R] \- Tune swap pages for performance, 0 means
tuning to singular pages rather than the default 3 which caches 8 for
HDD tuning, which can lower latency.
.IP \[bu] 2
\f[I]swappiness\f[R] \- Tune how aggressively the kernel will swap
pages, zram\-config defaults to 150 because the improved performance of
zram allows more usage without any adverse affects from the system
default of 60.
It can be raised up to 200 which will improve performance in high memory
pressure situations.
.IP \[bu] 2
\f[I]target_dir\f[R] \- The directory you wish to hold in zram, and the
original will be moved to an OverlayFS bind mount and is synchronized on
start, stop, and sync commands.
.IP \[bu] 2
\f[I]oldlog_dir\f[R] \- Used to enable log\-rotation to an off zram
directory while retaining only live logs in zram.
Usually in \f[CR]/opt\f[R] or \f[CR]/var\f[R], configuration is
optional.
.PP
To add additional devices, just add additional entries in
\f[CR]/etc/ztab\f[R].
To edit an active device, you must stop zram\-config and then edit any
entries.
Once any edits are complete start zram\-config for the changes to take
effect.
.SH REPORTING BUGS
For bug reports, use the issue tracker at
https://github.com/ecdye/zram\-config/issues.
.SH SEE ALSO
zramctl(8)
.SH AUTHORS
Ethan Dye.
